<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Clicksign : Rest API">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Clicksign</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/clicksign/rest-api">View on GitHub</a>

          <h1 id="project_title">Clicksign</h1>
          <h2 id="project_tagline">Rest API</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/clicksign/rest-api/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/clicksign/rest-api/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="tldr" class="anchor" href="#tldr" aria-hidden="true"><span class="octicon octicon-link"></span></a>TL;DR</h1>

<p>Particularidades da API da Clicksign:</p>

<ul>
<li>a versão da API está contida no caminho da requisição;</li>
<li>a chave da API é enviada como um dos parâmetros;</li>
<li>a chave da API é enviada em todas requisições;</li>
<li>a chave da API identifica e autentica o usuário;</li>
</ul>

<p>Fluxo de um documento:</p>

<ol>
<li>Upload do documento</li>
<li>Criação de hooks em um documento</li>
<li>Criação de uma lista de assinatura</li>
</ol>

<p>Cada documento possui uma chave única dentro da Clicksign.  Através desta chave
é feita toda referência a um documento.  É necessário criar uma lista de
documento para que um documento seja assinado.</p>

<p>Estão disponíveis bibliotecas para as seguintes plataformas:</p>

<ul>
<li><a href="https://www.nuget.org/packages/Clicksign4dotNet/">.Net</a></li>
<li><a href="https://github.com/clicksign/clicksign-ruby">Ruby</a></li>
</ul>

<h1>
<a id="Índice" class="anchor" href="#%C3%8Dndice" aria-hidden="true"><span class="octicon octicon-link"></span></a>Índice</h1>

<ul>
<li><a href="#introducao">Introdução</a></li>
<li><a href="#funcionamento-geral">Funcionamento geral</a></li>
<li><a href="#autenticacao">Autenticação</a></li>
<li><a href="#versao">Versão</a></li>
<li><a href="#formatos">Formatos</a></li>
<li><a href="#listagem-de-documentos">Listagem de documentos</a></li>
<li><a href="#visualizacao-de-documento">Visualizacão de Documento</a></li>
<li><a href="#upload-de-documentos">Upload de documentos</a></li>
<li><a href="#criacao-de-lista-de-assinatura">Criação de lista de assinatura</a></li>
<li><a href="#download-de-documento">Download de documento</a></li>
<li><a href="#criacao-de-pacote-de-documentos">Criação de pacote de documentos</a></li>
<li><a href="#hooks">Hooks</a></li>
<li><a href="#exemplos">Exemplos</a></li>
</ul>

<h1>
<a id="introdução" class="anchor" href="#introdu%C3%A7%C3%A3o" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="introducao"></a>Introdução</h1>

<p>A Clicksign é uma solução online para enviar, guardar e assinar documentos, com validade jurídica. Foi criada para facilitar, reduzir custo e aumentar a segurança e compliance do processo de assinatura e <em>workflow</em> de documentos. </p>

<p>A Clicksign pode ser acessada em <a href="https://desk.clicksign.com">https://desk.clicksign.com</a>. </p>

<p>O propósito desta <strong>REST API</strong> é prover meios para que nossos clientes adequem a Clicksign aos seus processos e sistemas p. ex. automatizar tarefas, desenhar fluxos de assinatura, e definir <em>workflow</em>. </p>

<p>Qualquer linguagem de programação compativel com requisições <strong>HTTP / JSON</strong> cumpre os requisitos necessários para consumir os serviços desta API. Assim, com pouco esforço de programação é possível integrar desde scripts shell até sistemas de ERP.</p>

<h1>
<a id="funcionamento-geral" class="anchor" href="#funcionamento-geral" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="funcionamento-geral"></a>Funcionamento geral</h1>

<p>Uma <em>REST API</em> é composta, basicamente, por dois elementos: um <strong>cliente</strong> e um <strong>servidor</strong>. O cliente sempre inicia a comunicação mediante requisição HTTP. O servidor sempre finaliza a comunicação respondendo à requisição.</p>

<p align="center">
  <img src="https://raw.github.com/clicksign/rest-api-v2/master/images/client-server.png">
</p>

<p>As mensagens HTTP são compostas por uma linha inicial, um conjunto de cabeçalhos e um corpo. A linha inicial difere nas requisições e nas respostas, o cabeçalho compartilha parâmetros em comum e parâmetros específicos, e o corpo é completamente dependente de cada mensagem, podendo até ser nulo.</p>

<p>A requisição, em sua linha inicial, indica o <strong>método</strong>, o <strong>caminho</strong>, e a <strong>versão do protocolo</strong>. O método e o caminho são essenciais em uma <em>REST API</em> uma vez que ambos indicam a ação a ser executada no servidor.</p>

<p>A resposta, em sua linha inicial, indica a <strong>versão do protocolo</strong>, o <strong>status</strong>, e contém uma <strong>mensagem informativa</strong>. O código de status é essencial para o cliente saber se a ação foi devidamente executada no servidor.</p>

<p>A documentação de cada função da API determina o método e o caminho a ser utilizado, e o significado do corpo e de cada status da resposta.</p>

<p><strong>Atenção:</strong> Toda a comunição cliente/servidor é feita através de HTTP sobre SSL/TLS (HTTPS). Requisições em HTTP simples resultam em redirecionamentos (301) para o protocolo HTTPS.</p>

<p>Todas as requisições da <em>REST API</em> são feitas para <code>api.clicksign.com</code>.</p>

<h2>
<a id="exemplo-de-requisição" class="anchor" href="#exemplo-de-requisi%C3%A7%C3%A3o" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemplo de requisição</h2>

<pre lang="http"><code>GET /documents HTTPS/1.1
Host: api.clicksign.com
Accept: application/json
</code></pre>

<ul>
<li>Método: GET</li>
<li>Caminho: /documents</li>
<li>Versão: 1.1</li>
<li>Cabeçalhos: Host, Accept</li>
<li>Corpo: vazio</li>
</ul>

<h2>
<a id="exemplo-de-resposta" class="anchor" href="#exemplo-de-resposta" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemplo de resposta</h2>

<pre lang="http"><code>HTTP/1.1 200 OK
Content-Type:application/json
Connection: Keep-Alive
</code></pre>

<div class="highlight highlight-json"><pre>[
  {
    <span class="s2">"id"</span>: <span class="s2">"abcd..."</span>
  },

  {
    <span class="s2">"id"</span>: <span class="s2">"..."</span>
  }
]</pre></div>

<ul>
<li>Versão: 1.1</li>
<li>Status: 200</li>
<li>Mensagem: OK</li>
<li>Cabeçalhos: Content-Type, Connection</li>
<li>Corpo: [{...</li>
</ul>

<h1>
<a id="autenticação" class="anchor" href="#autentica%C3%A7%C3%A3o" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="autenticacao"></a>Autenticação</h1>

<p>A Clicksign utiliza duplo fator de autenticação para aumentar a segurança de suas transações. Autenticações que utilizam duplo fator geralmente são baseadas em algo que o cliente <em>conhece</em> e algo que o cliente <em>possui</em>. No caso da API os fatores são:</p>

<ol>
<li>Conhecer uma <em>string</em> de <strong>identificação</strong>
</li>
<li>Possuir um endereço <strong>IP</strong> específico</li>
</ol>

<p>A autenticação é feito através do parâmetro <strong>access_token</strong> que automaticamente determina um usuário e realiza sua autenticação. O parâmetro deve ser enviado no <strong>caminho</strong> da requisição. Portanto, toda requisição deverá conter no <em>path</em> <code>?access_token=string-do-token</code>._</p>

<p><strong>Atenção:</strong> O parâmetro de autenticação deve ser enviado a cada requisição feita pelo cliente. Como esse parâmetro é comum a todas as funções da API, ele será omitido das documentações.</p>

<p>O segundo fator da autenticação é realizado automaticamente pelo servidor da Clicksign, que verifica se o <strong>IP</strong> de origem da requisição está dentro de uma lista de endereços previamente cadastrados para determinado cliente. Este fator de autenticação é <strong>opcional</strong>.</p>

<h1>
<a id="versão-da-api" class="anchor" href="#vers%C3%A3o-da-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="versao"></a>Versão da API</h1>

<p>Para possibilitar a expansão contínua da API, a Clicksign implementa um sistema
de versões. Dessa forma é necessário que a requisição contenha qual versão da
API está sendo utilizada. Isto <strong>é feito através do path</strong> da requisição.</p>

<p>A Clicksign manterá, além da versão atual, a versão anterior da sua API em
funcionamento. Quando uma nova versão é lançada, a versão anterior deixa de ser
suportada, p.e.: supondo que a versão atual seja 4, a versão 3 também será
suportada, no lançamento da versão 5, as versões suportadas serão 5 e 4 e a
versão 3 deixará de ser suportada.</p>

<p>Um nova versão é lançada <strong>apenas quando há quebra de funcionalidade</strong>. Ou seja,
melhorias, novas funcionalidades e correções de <em>bugs</em>, desde que não alterem o
comportamento esperado, não implicam no lançamento de uma nova versão.</p>

<p>As melhorias, novas funcionalidades e correções, assim como o lançamento de novas
versões da API, serão comunicados através de e-mail para todos os usuários que
possuem chave da API configurada nos ambientes de <em>production</em> e <em>demo</em>.</p>

<h1>
<a id="-formatos" class="anchor" href="#-formatos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="formatos"></a> Formatos</h1>

<p>A API da Clicksign atualmente aceita dois formatos distintos como formato de
<em>resposta</em> da requisição, sendo eles: <code>JSON</code> e <code>XML</code>. O formato deve ser
passado através do <code>HTTP HEADER</code> <code>Accept</code> seguido do <strong>mime type</strong> referente ao
formato. Por exemplo, para que o formato de sua resposta seja em <code>JSON</code>, será
necessário prover um header com o seguinte formato:</p>

<pre><code>Accept: application/json
</code></pre>

<p>Caso deseje receber o formato da resposta em <code>XML</code> basta passar dessa forma:</p>

<pre><code>Accept: application/xml
</code></pre>

<p>Nos exemplos restantes dessa documentação o formato da resposta serão mostrados
em JSON, porém todos os exemplos também podem ter as respostas no formato <code>XML</code>.</p>

<h1>
<a id="listagem-de-documentos" class="anchor" href="#listagem-de-documentos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="listagem-de-documentos"></a>Listagem de documentos</h1>

<p>Você pode obter uma listagem de todos os documentos da conta além de informações extras pertinentes ao andamento da lista de assinatura. A listagem retornará todos os documentos na conta, sem a necessidade de parâmetros de paginação ou busca.</p>

<ul>
<li>
<strong>Method:</strong> GET</li>
<li>
<strong>Path:</strong> /v1/documents

<ul>
<li>
<strong>Accept</strong>: application/json</li>
</ul>
</li>
</ul>

<h2>
<a id="exemplo-de-resposta-1" class="anchor" href="#exemplo-de-resposta-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemplo de resposta</h2>

<pre lang="http"><code>HTTP/1.1 200 OK
Content-Type:application/json
Connection: Keep-Alive
</code></pre>

<div class="highlight highlight-json"><pre>[
  {
    <span class="s2">"document"</span>: {
      <span class="s2">"key"</span>: <span class="s2">"1123-4567-89ab-cdef"</span>,
      <span class="err">original_name</span>: <span class="s2">"document-2.pdf"</span>
      <span class="s2">"status"</span><span class="err">:</span> <span class="s2">"completed"</span>,
      <span class="s2">"archive_id"</span>: <span class="m">2</span>,
      <span class="s2">"created_at"</span>: <span class="s2">"2014-06-18T09:55:16.873-03:00"</span>,
      <span class="s2">"updated_at"</span>: <span class="s2">"2014-06-18T10:02:03.056-03:00"</span>,
      <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
      <span class="s2">"list"</span>: {
        <span class="s2">"locked"</span>:<span class="kc">null</span>,
        <span class="s2">"started_at"</span>:<span class="kc">null</span>,
        <span class="s2">"created_at"</span>:<span class="s2">"2014-06-18T09:57:14.434-03:00"</span>,
        <span class="s2">"updated_at"</span>:<span class="s2">"2014-06-18T09:57:14.434-03:00"</span>,
        <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
        <span class="s2">"signatures"</span>: []
      }
    }
  },
  {
    <span class="s2">"document"</span>: {
      <span class="s2">"key"</span>: <span class="s2">"0123-4567-89ab-cdef"</span>,
      <span class="err">original_name</span>: <span class="s2">"document-1.pdf"</span>
      <span class="s2">"status"</span><span class="err">:</span> <span class="s2">"completed"</span>,
      <span class="s2">"archive_id"</span>: <span class="m">1</span>,
      <span class="s2">"created_at"</span>: <span class="s2">"2014-06-18T09:55:16.873-03:00"</span>,
      <span class="s2">"updated_at"</span>: <span class="s2">"2014-06-18T10:02:03.056-03:00"</span>,
      <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
      <span class="s2">"list"</span>: {
        <span class="s2">"locked"</span>:<span class="kc">null</span>,
        <span class="s2">"started_at"</span>:<span class="s2">"2014-06-18T09:58:46.450-03:00"</span>,
        <span class="s2">"created_at"</span>:<span class="s2">"2014-06-18T09:57:14.434-03:00"</span>,
        <span class="s2">"updated_at"</span>:<span class="s2">"2014-06-18T09:58:46.452-03:00"</span>,
        <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
        <span class="s2">"signatures"</span>: [
          {
            <span class="s2">"display_name"</span>:<span class="s2">"Daniel Gaboardi Libanori"</span>,
            <span class="s2">"title"</span>:<span class="kc">null</span>,
            <span class="s2">"company_name"</span>:<span class="kc">null</span>,
            <span class="s2">"key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
            <span class="s2">"act"</span>:<span class="s2">"receipt"</span>,
            <span class="s2">"decision"</span>:<span class="s2">"agreed"</span>,
            <span class="s2">"address"</span>:<span class="s2">"201.81.113.174"</span>,
            <span class="s2">"email"</span>:<span class="s2">"daniel.libanori@clicksign.com"</span>,
            <span class="s2">"signed_at"</span>:<span class="s2">"2014-06-18T09:59:58.713-03:00"</span>,
            <span class="s2">"created_at"</span>:<span class="s2">"2014-06-18T09:57:24.191-03:00"</span>,
            <span class="s2">"updated_at"</span>:<span class="s2">"2014-06-18T09:59:58.836-03:00"</span>
          },
          {
            <span class="s2">"display_name"</span>:<span class="s2">"Daniel Gaboardi Libanori"</span>,
            <span class="s2">"title"</span>:<span class="kc">null</span>,
            <span class="s2">"company_name"</span>:<span class="kc">null</span>,
            <span class="s2">"key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
            <span class="s2">"act"</span>:<span class="s2">"intervening"</span>,
            <span class="s2">"decision"</span>:<span class="s2">"agreed"</span>,
            <span class="s2">"address"</span>:<span class="s2">"201.81.113.174"</span>,
            <span class="s2">"email"</span>:<span class="s2">"daniel.libanori@clicksign.com"</span>,
            <span class="s2">"signed_at"</span>:<span class="s2">"2014-06-18T10:01:18.327-03:00"</span>,
            <span class="s2">"created_at"</span>:<span class="s2">"2014-06-18T09:57:31.114-03:00"</span>,
            <span class="s2">"updated_at"</span>:<span class="s2">"2014-06-18T10:01:18.389-03:00"</span>
          }
        ]
      }
    }
  }
]</pre></div>

<h2>
<a id="resposta-4xx" class="anchor" href="#resposta-4xx" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 4XX</h2>

<p>Caso o cliente utilize parâmetros inválidos, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Invalid parameters."</span> }</pre></div>

<h2>
<a id="resposta-5xx" class="anchor" href="#resposta-5xx" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 5XX</h2>

<p>Caso ocorra qualquer tipo de falha no servidor, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Server error."</span> }</pre></div>

<h1>
<a id="visualização-de-documentos" class="anchor" href="#visualiza%C3%A7%C3%A3o-de-documentos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="visualizacao-de-documento"></a>Visualização de documentos</h1>

<p>Caso seja necessário obter detalhes sobre um documento em específico, existe um <em>endpoint</em> onde é possível
obter essas informações. A visualização de um documento funciona de forma
semelhante as demais chamadas da api, sendo necessário apenas passar a <strong>key</strong>
do documento.</p>

<ul>
<li>
<strong>Method:</strong> GET</li>
<li>
<strong>Path:</strong> /v1/documents/:key

<ul>
<li>
<strong>Accept</strong>: application/json</li>
</ul>
</li>
</ul>

<h2>
<a id="exemplo-de-resposta-2" class="anchor" href="#exemplo-de-resposta-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemplo de resposta</h2>

<pre lang="http"><code>HTTP/1.1 200 OK
Content-Type:application/json
Connection: Keep-Alive
</code></pre>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"document"</span>: {
    <span class="s2">"key"</span>: <span class="s2">"1123-4567-89ab-cdef"</span>,
    <span class="err">original_name</span>: <span class="s2">"document-2.pdf"</span>
    <span class="s2">"status"</span><span class="err">:</span> <span class="s2">"completed"</span>,
    <span class="s2">"archive_id"</span>: <span class="m">2</span>,
    <span class="s2">"created_at"</span>: <span class="s2">"2014-06-18T09:55:16.873-03:00"</span>,
    <span class="s2">"updated_at"</span>: <span class="s2">"2014-06-18T10:02:03.056-03:00"</span>,
    <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
    <span class="s2">"list"</span>: {
      <span class="s2">"locked"</span>:<span class="kc">null</span>,
      <span class="s2">"started_at"</span>:<span class="kc">null</span>,
      <span class="s2">"created_at"</span>:<span class="s2">"2014-06-18T09:57:14.434-03:00"</span>,
      <span class="s2">"updated_at"</span>:<span class="s2">"2014-06-18T09:57:14.434-03:00"</span>,
      <span class="s2">"user_key"</span>:<span class="s2">"A0BF-848B-0A42-916C"</span>,
      <span class="s2">"signatures"</span>: []
    }
  }
}</pre></div>

<h2>
<a id="resposta-4xx-1" class="anchor" href="#resposta-4xx-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 4XX</h2>

<p>Caso o cliente utilize parâmetros inválidos, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Invalid parameters."</span> }</pre></div>

<h2>
<a id="resposta-5xx-1" class="anchor" href="#resposta-5xx-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 5XX</h2>

<p>Caso ocorra qualquer tipo de falha no servidor, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Server error."</span> }</pre></div>

<h1>
<a id="upload-de-documentos" class="anchor" href="#upload-de-documentos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="upload-de-documentos"></a>Upload de documentos</h1>

<p>O processo de envio de um documento para a Clicksign contempla a criação de um arquivo de <strong>log</strong> contendo informações de <em>upload</em>, usuário, etc, anexado a uma cópia do documento "carimbada" com um <strong>número de série</strong>. Ao final do processo haverá 2 arquivos na Clicksign: documento original e arquivo de log. Enquanto o arquivo é processado a requisição <em>não fica bloqueada</em>. O <em>status</em> do documento será <em>working</em> enquanto o processo ocorre. Após concluído, o <em>status</em> será <em>open</em>.</p>

<p>O nome do parâmetro do documento a ser enviado é <strong>document[archive][original]</strong>. O parâmetro geralmente vai dentro do corpo (<em>payload</em>) devido a requisição ser <em>multipart</em>.</p>

<ul>
<li>
<strong>Method:</strong> POST</li>
<li>
<strong>Path:</strong> /v1/documents

<ul>
<li>
<strong>Accept</strong>: application/json</li>
<li>
<strong>Content-Type:</strong> multipart/form-data; boundary=----WebKitFormBoundaryjm7rLhiPSO6cEjWs</li>
</ul>
</li>
<li>
<p><strong>Corpo:</strong></p>

<pre><code>------WebKitFormBoundaryjm7rLhiPSO6cEjWs
Content-Disposition: form-data; name="document[archive][original]"; filename="06pages.pdf"
Content-Type: application/pdf

------WebKitFormBoundaryjm7rLhiPSO6cEjWs--
</code></pre>
</li>
</ul>

<h2>
<a id="exemplo-de-resposta-3" class="anchor" href="#exemplo-de-resposta-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemplo de resposta</h2>

<pre lang="http"><code>HTTP/1.1 200 OK
Content-Type:application/json
Connection: Keep-Alive
</code></pre>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"key"</span>: <span class="s2">"0123-4567-89ab-cdef"</span>,
  <span class="s2">"status"</span>: <span class="s2">"working"</span>
}</pre></div>

<h2>
<a id="resposta-4xx-2" class="anchor" href="#resposta-4xx-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 4XX</h2>

<p>Caso o cliente utilize parâmetros inválidos, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Invalid parameters."</span> }</pre></div>

<h2>
<a id="resposta-5xx-2" class="anchor" href="#resposta-5xx-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 5XX</h2>

<p>Caso ocorra qualquer tipo de falha no servidor, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li><strong>Corpo:</strong></li>
</ul>

<div class="highlight highlight-json"><pre>{ <span class="s2">"message"</span>: <span class="s2">"Server error."</span> }</pre></div>

<h1>
<a id="criação-de-lista-de-assinatura" class="anchor" href="#cria%C3%A7%C3%A3o-de-lista-de-assinatura" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="criacao-de-lista-de-assinatura"></a>Criação de lista de assinatura</h1>

<p>É possível criar uma lista de assinatura e enviá-la a outras pessoas em uma única ação. Para isso, é necessário que estejam presentes os campos que especificam o documento, os signatários, a mensagem e opcionalmente se deseja enviar e-mail para os signatários ou não.</p>

<ul>
<li>
<strong>Method:</strong> POST</li>
<li>
<strong>Path:</strong> /v1/documents/:key/list</li>
<li>
<strong>Cabeçalhos:</strong>

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
<li>
<strong>Accept</strong>: application/json</li>
</ul>
</li>
<li>
<p><strong>Corpo:</strong></p>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"signers"</span>: [
    { <span class="s2">"email"</span>: <span class="s2">"foo@example.com"</span>, <span class="s2">"act"</span>: <span class="s2">"sign"</span> },
    { <span class="s2">"email"</span>: <span class="s2">"bar@example.com"</span>, <span class="s2">"act"</span>: <span class="s2">"witness"</span> }
  ],

  <span class="s2">"message"</span>: <span class="s2">"Hi guys, please sign this document."</span>,
  <span class="s2">"skip_email"</span>: <span class="kc">false</span>
}</pre></div>
</li>
</ul>

<p>Para criar uma lista de assinatura, adicionar signatários ao documento e iniciar o processo de assinatura automaticamente, deve-se adicionar um campo <code>signers</code> ao JSON. Caso não haja o campo <code>signers</code> ou ele seja <code>null</code>, o documento não possuirá lista de assinatura definida.</p>

<p>O campo <code>signers</code> deverá ser um <code>Array</code> contendo os signatários. Cada signatário é especificado através de e-mail e ação, sendo os respectivos campos <code>email</code> e <code>act</code>.</p>

<p>Os possíveis valores de <code>act</code> são:</p>

<ul>
<li>sign</li>
<li>approve</li>
<li>acknowledge</li>
<li>witness</li>
<li>intervenient</li>
<li>party</li>
<li>receipt</li>
</ul>

<p>A mensagem a ser enviada aos signatários é definida pelo campo <code>message</code>.</p>

<p>Além disso também é possível especificar se deseja ao iniciar a lista de assinatura que seja enviado um e-mail para os signatários ou não, isso é feito através do parâmetro <code>skip_email</code> que recebe um boolean.</p>

<p>Os possíveis valores de <code>skip_email</code> são:</p>

<ul>
<li>false (padrão)</li>
<li>true</li>
</ul>

<p>Caso o parâmetro seja passado como <strong>true</strong> ao criar a lista de assinatura não será enviado nenhum e-mail para os signatários. É importante notar
que caso seja fornecido o parâmetro <code>skip_email</code><code>como *true*, o parâmetro</code>message<code>se torna desnecessário dado que não será enviado nenhum e-mail. Também
é importante observar que como o valor padrão desse parâmetro é</code>false` ele pode ser omitido do json que é enviado para o servidor caso você deseje enviar os e-mails normalmente.</p>

<h1>
<a id="download-de-documento" class="anchor" href="#download-de-documento" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="download-de-documento"></a>Download de documento</h1>

<p>Você pode realizar download de um arquivo.  O arquivo original empacotado com um arquivo de log e enviado em <strong>formato ZIP</strong>.  O empacotamento é realizado sob demanda e em <em>background</em>, para isso, o servidor não irá aguardar a conclusão do empacotamento para retornar a requisição, ao invés disso, ele irá retorna uma respota com <em>status</em> 201 indicando o início do empacotamento.  Enquanto ocorre o empacotamento o servidor irá retornar a mesma resposta 201.  Quando o processo for concluído, a resposta será código 200 contendo em seu corpo o ZIP.</p>

<p>Você deverá realizar uma espera ativa, efetuando diversas requisições e obtendo respostas 201 até obter um código 200.  O empacotamento ocorre em 2 ou 3 segundos no máximo, por isso, <strong>recomendamos realizar uma requisição por segundo</strong> até você obter um código 200, dessa forma em 2 ou 3 requisições você obterá o ZIP.</p>

<ul>
<li>
<strong>Method:</strong> GET</li>
<li>
<strong>Path:</strong> /v1/documents/:key/download</li>
<li>
<strong>Cabeçalhos:</strong>

<ul>
<li>
<strong>Accept</strong>: application/json</li>
</ul>
</li>
</ul>

<h1>
<a id="criação-de-pacote-de-documentos" class="anchor" href="#cria%C3%A7%C3%A3o-de-pacote-de-documentos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="criacao-de-pacote-de-documentos"></a>Criação de pacote de documentos</h1>

<p>Você pode criar um pacote de documentos caso você deseja possibilitar ao signatário que ele assine todos os documentos em uma única etapa (<em>feature</em> atualmente disponível apenas via <em>widget</em>).  Para isto, é necessário que os documentos sejam <em>empacotados</em> em uma estrutura.  A criação de um pacote é extremamente simples, basta fazer uma requisição com o <em>array</em> de documentos que devam compor o pacote.</p>

<ul>
<li>
<strong>Method:</strong> POST</li>
<li>
<strong>Path:</strong> /v1/batches</li>
<li>
<strong>Cabeçalhos:</strong>

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
<li>
<strong>Accept</strong>: application/json</li>
</ul>
</li>
<li>
<p><strong>Corpo:</strong></p>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"keys"</span>: [
    <span class="s2">"0b2ec469-6b49-42bb-809f-d978279baeeb"</span>,
    <span class="s2">"db75a09b-6b30-48b9-b9f0-873951a050ed"</span>,
    <span class="s2">"42334730-5a93-48ae-b5e4-e8e86d62610a"</span>
  ]
}</pre></div>
</li>
</ul>

<h1>
<a id="hooks" class="anchor" href="#hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="hooks"></a>Hooks</h1>

<p>É possível que a Clicksign notifique outras aplições à respeito da alteração de estado de um determinado documento. O estado de um documento é alterado quando um dos seguintes eventos ocorrem:</p>

<ul>
<li>o documento é processado</li>
<li>alguém se recusa a assinar o documento</li>
<li>o documento é completamente assinado</li>
</ul>

<p>Para isso, a Clicksign dispõe de um sistema de <strong>hooks</strong> que realizam chamadas HTTP para outras aplicações. As <em>hooks</em> são definidas por documento, portanto cada documento deve configurar as <em>hooks</em> com os parâmetros que deseja.</p>

<p>Quando o documento alterar o seu estado, a Clicksign irá realizar um POST para a <code>url</code> que foi configurada na <em>hook</em> do documento. No corpo da requisição irá em anexo a chave do documento em formato JSON. Portanto você pode determinar para cada documento um endereço específico a ser notificado ou colocar em todos os documentos o mesmo endereço a ser notificado e o servidor que atender a requisição inspecionar o JSON e determinar o que fazer com cada documento em particular.</p>

<ul>
<li>
<strong>URL</strong>: caminho completo, incluíndo protocolo</li>
<li>
<strong>Content-Type</strong>: application/json</li>
</ul>

<h2>
<a id="configuração-de-hooks" class="anchor" href="#configura%C3%A7%C3%A3o-de-hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuração de hooks</h2>

<p>Cadastra um <em>hook</em> para um determinado usuário.</p>

<ul>
<li>
<strong>Method:</strong> POST</li>
<li>
<strong>Path:</strong> /v1/documents/:key/hooks</li>
<li>
<strong>Corpo:</strong>
<code>json
{
  "url": "https://example.com/signed/123",
}
</code>
</li>
</ul>

<h2>
<a id="resposta-200" class="anchor" href="#resposta-200" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 200</h2>

<p>Caso não ocorra nenhuma falha na requisição, a resposta será status 200 e seu corpo será um JSON contendo os dados da <em>hook</em> recém criada.</p>

<pre lang="http"><code>HTTP/1.1 200 OK
Content-Type:application/json
</code></pre>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"id"</span>:<span class="m">1</span>,
  <span class="s2">"url"</span>:<span class="s2">"http://example.com"</span>,
  <span class="s2">"document_id"</span>: <span class="m">1</span>,
  <span class="s2">"created_at"</span>:<span class="s2">"2014-07-08T12:35:55.777-03:00"</span>,
  <span class="s2">"updated_at"</span>:<span class="s2">"2014-07-08T12:35:55.777-03:00"</span>
}</pre></div>

<h2>
<a id="resposta-4xx-3" class="anchor" href="#resposta-4xx-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 4XX</h2>

<p>Caso o cliente utilize parâmetros inválidos, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li>
<p><strong>Corpo:</strong></p>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"message"</span>: <span class="s2">"Parâmetros inválidos."</span>
}</pre></div>
</li>
</ul>

<h2>
<a id="resposta-5xx-3" class="anchor" href="#resposta-5xx-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resposta 5XX</h2>

<p>Caso ocorra qualquer tipo de falha no servidor, o corpo da resposta será um <em>JSON</em> contendo uma mensagem de erro.</p>

<ul>
<li>
<strong>Cabeçalhos</strong>:

<ul>
<li>
<strong>Content-Type:</strong> application/json</li>
</ul>
</li>
<li>
<p><strong>Corpo:</strong></p>

<div class="highlight highlight-json"><pre>{
  <span class="s2">"message"</span>: <span class="s2">"Server error."</span>
}</pre></div>
</li>
</ul>

<h1>
<a id="exemplos" class="anchor" href="#exemplos" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<a name="exemplos"></a>Exemplos</h1>

<p>Os exemplos abaixo podem ser executados direto da linha de comando utilizando o cURL.</p>

<div class="highlight highlight-bash"><pre><span class="k">export</span> DOMAIN=api.clicksign.com
<span class="k">export</span> TOKEN=put-your-token-here
<span class="k">export</span> DOCUMENT=/home/joe/document-de-exemplo.pdf

<span class="c1"># Obter os documentos de uma determinada conta</span>
curl -X GET -H <span class="s2">"Accept: application/json"</span> https://<span class="nv">$DOMAIN</span>/v1/documents/<span class="o">?</span>access_token=<span class="nv">$TOKEN</span>

<span class="c1"># Realizar upload de um documento</span>
curl -X POST -H <span class="s2">"Accept: application/json"</span> -F <span class="s2">"document[archive][original]=@<span class="nv">$DOCUMENT</span>"</span> https://<span class="nv">$DOMAIN</span>/v1/documents<span class="o">?</span>access_token=<span class="nv">$TOKEN</span>

<span class="k">export</span> KEY=ver-key-retornada-no-JSON

<span class="c1"># Criar uma lista de assinatura</span>
curl -X POST -H <span class="s2">"Accept: application/json"</span> -H <span class="s2">"Content-type: application/json"</span> -d <span class="s1">'{"signers": [{ "email": "joe@example.com", "act": "sign" }]}'</span> https://<span class="nv">$DOMAIN</span>/v1/documents/<span class="nv">$KEY</span>/list<span class="o">?</span>access_token=<span class="nv">$TOKEN</span></pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Clicksign maintained by <a href="https://github.com/clicksign">clicksign</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
